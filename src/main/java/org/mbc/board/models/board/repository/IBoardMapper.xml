<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="org.mbc.board.models.board.repository.IBoardMapper">

	<select id="getBoardList" resultType="org.mbc.board.models.board.domain.GetBoardListVO">
		<![CDATA[
			SELECT 
				board_index as boardIndex, 
				board_title as title, 
				board_view_count as viewCount, 
				board_create_date as createDate, 
				board_update_date as updateDate, 
				user_name as writer 
				
			FROM 
				board_tbl B JOIN user_tbl U 
					ON 
						B.user_id = U.user_id
				
			ORDER BY 
				board_index DESC
		]]>
	</select>
	
	<select id="getBoardDetail" resultType="org.mbc.board.models.board.domain.GetBoardDetailVO">
		<![CDATA[
			SELECT 
				board_index as boardIndex, 
				board_title as title, 
				board_content as content, 
				board_view_count as viewCount, 
				board_create_date as createDate, 
				board_update_date as updateDate, 
				user_name as writer 
			FROM board_tbl B JOIN user_tbl U 
				ON B.user_id = U.user_id 
			WHERE board_index = #{boardIndex}
		]]>
	</select>

	<insert id="postBoard">
		<![CDATA[
			INSERT INTO board_tbl (
				board_index, 
				board_title, 
				board_content, 
				user_id) 
				
				VALUES (
				board_seq.nextval, 
				#{title}, 
				#{content}, 
				#{writer})
		]]>
	</insert>

	<insert id="postBoardGetKey">
		<selectKey keyProperty="boardIndex" order="BEFORE" resultType="long">
			SELECT board_seq.nextval FROM dual
		</selectKey>
		
		<![CDATA[
			INSERT INTO board_tbl (
				board_index, 
				board_title, 
				board_content, 
				user_id) 
				
				VALUES (
				#{boardIndex}, 
				#{title}, 
				#{content}, 
				#{writer})
		]]>
	</insert>
	
	<delete id="deleteBoard">
		<![CDATA[
			DELETE FROM board_tbl 
			
			WHERE 
				board_index = #{boardIndex}
		]]>
	</delete>
	
	<update id="updateBoard">
		<![CDATA[
			UPDATE board_tbl 
			
			SET
				board_title = #{title},
				board_content = #{content},
				board_update_date = SYSDATE
			
			WHERE 
				board_index = #{boardIndex}
		]]>
	</update>
	
	<update id="increaseViewCount" parameterType="long">
		<![CDATA[
			UPDATE board_tbl 
			
			SET
				board_view_count = board_view_count + 1
			
			WHERE 
				board_index = #{boardIndex}
		]]>
	</update>
	
	
</mapper>